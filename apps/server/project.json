{
  "name": "server",
  "$schema": "../../node_modules/nx/schemas/project-schema.json",
  "projectType": "application",
  "sourceRoot": "apps/server/src",
  "implicitDependencies": [
    "client",
    "coday-events",
    "ai-thread"
  ],
  "tags": ["web-server"],
  "targets": {
    "build": {
      "inputs": [
        "default",
        "{workspaceRoot}/libs/**/*",
        "{workspaceRoot}/apps/client/**/*"
      ],
      "executor": "nx:run-commands",
      "dependsOn": [
        {
          "projects": "client",
          "target": "build"
        },
        {
          "target": "build-server"
        }
      ],
      "outputs": ["{projectRoot}/dist/web"],
      "options": {
        "commands": [
          "cp -r apps/client/dist/browser apps/server/dist/client",
          "cp apps/server/package.json apps/server/dist/package.json",
          "cp apps/server/bin.js apps/server/dist/bin.js"
        ],
        "parallel": false
      }
    },
    "build-server": {
      "executor": "@nx/esbuild:esbuild",
      "outputs": ["{options.outputPath}"],
      "options": {
        "assets": [],
        "bundle": true,
        "minify": true,
        "esbuildOptions": {
          "outExtension": {
            ".js": ".js"
          },
          "sourcemap": false,
          "banner": {
            "js": "import { createRequire as __createRequire } from 'module';import { dirname as __dirname_func } from 'path';const require = __createRequire(import.meta.url);const __filename = import.meta.url.slice(7);const __dirname = __dirname_func(__filename);"
          }
        },
        "external": ["sharp"],
        "format": ["esm"],
        "main": "apps/server/src/server.ts",
        "outputFileName": "server.js",
        "outputPath": "{projectRoot}/dist",
        "platform": "node",
        "thirdParty": true,
        "tsConfig": "apps/server/tsconfig.app.json"
      }
    },
    "serve:production": {
      "executor": "nx:run-commands",
      "dependsOn": ["server:build"],
      "options": {
        "commands": ["node apps/server/dist/bin.js --no_auth"],
        "parallel": false
      }
    },
    "serve": {
      "executor": "nx:run-commands",
      "options": {
        "env": {
          "BUILD_ENV": "development"
        },
        "commands": ["tsx watch apps/server/src/server.ts --local --no_auth"]
      }
    }
  }
}

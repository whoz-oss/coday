<!-- Floating Action Button -->
<button 
  class="floating-menu-btn"
  (click)="toggleMenu()"
  [class.active]="isMenuOpen"
  title="Menu Coday"
>
  <img src="CODAY-Logo.png" alt="Coday" class="logo" />
  <div class="hamburger-overlay">â˜°</div>
</button>

<!-- Menu dropdown -->
<div 
  *ngIf="isMenuOpen" 
  class="floating-menu"
  (click)="$event.stopPropagation()"
  (keydown)="$event.stopPropagation()"
  tabindex="-1"
  role="menu"
  aria-label="Menu principal de Coday"
>
  <!-- Project selector - moved to top -->
  <div class="menu-section project-selector-section">
    <app-project-selector class="main-project-selector"></app-project-selector>
  </div>
  
  <!-- Navigation -->
  <div class="menu-section navigation">
    <!-- Thread selector - now functional -->
    <app-thread-selector class="main-thread-selector"></app-thread-selector>
  </div>
  
  <!-- Configuration -->
  <div class="menu-section configuration">
    <button class="menu-item" (click)="openUserConfig()">
      <span class="menu-icon">ğŸ‘¤</span>
      <span class="menu-text">User Config</span>
    </button>
    
    <button 
      class="menu-item" 
      (click)="openProjectConfig()"
      [disabled]="!hasProject()"
      [title]="hasProject() ? 'Edit project configuration' : 'No project selected'"
    >
      <span class="menu-icon">ğŸ“</span>
      <span class="menu-text">Project Config</span>
      <span *ngIf="!hasProject()" class="disabled-hint">(No project)</span>
    </button>
  </div>
  
  <!-- Settings -->
  <div class="menu-section">
    <div class="menu-item-wrapper">
      <span class="menu-text">Theme</span>
      <app-theme-selector class="inline-selector"></app-theme-selector>
    </div>
    
    <div class="menu-item-wrapper">
      <span class="menu-text">Preferences</span>
      <app-options-panel class="inline-panel"></app-options-panel>
    </div>
  </div>
</div>

<!-- JSON Editor Modals -->
<app-json-editor 
  [configType]="'user'"
  [isOpen]="isUserConfigOpen"
  [initialContent]="userConfigJson"
  [isLoading]="isLoadingUserConfig"
  [isSaving]="isSavingUserConfig"
  (save)="onUserConfigSave($event)"
  (cancel)="onUserConfigCancel()"
></app-json-editor>

<app-json-editor 
  *ngIf="hasProject()"
  [configType]="'project'" 
  [projectName]="getCurrentProjectName()!"
  [isOpen]="isProjectConfigOpen"
  [initialContent]="projectConfigJson"
  [isLoading]="isLoadingProjectConfig"
  [isSaving]="isSavingProjectConfig"
  (save)="onProjectConfigSave($event)"
  (cancel)="onProjectConfigCancel()"
></app-json-editor>

<!-- Backdrop pour fermer le menu -->
<div 
  *ngIf="isMenuOpen" 
  class="menu-backdrop"
  (click)="closeMenu()"
  (keydown.escape)="closeMenu()"
  tabindex="-1"
  role="button"
  aria-label="Fermer le menu (cliquez ou appuyez sur Ã‰chap)"
></div>
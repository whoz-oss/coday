<div class="project-selector" (click)="$event.stopPropagation()">
  <!-- Main selector button -->
  <button 
    class="selector-button"
    [class.clickable]="isClickable()"
    [class.expanded]="isExpanded"
    [disabled]="!isClickable()"
    (click)="toggleDropdown()"
    type="button"
  >
    <span class="selector-icon">{{ getIcon() }}</span>
    <span class="selector-text">{{ getDisplayText() }}</span>
    <span class="dropdown-arrow" *ngIf="canShowDropdown()">
      {{ isExpanded ? '▲' : '▼' }}
    </span>
  </button>
  
  <!-- Dropdown menu -->
  <div 
    *ngIf="isExpanded && canShowDropdown()" 
    class="dropdown-menu"
    role="menu"
    aria-label="Sélection de projet"
  >
    <button
      *ngFor="let project of getAvailableProjects(); trackBy: trackByProjectName"
      class="dropdown-item"
      [class.current]="project.name === projects?.current"
      (click)="selectProject(project.name)"
      type="button"
      role="menuitem"
    >
      <span class="project-name">{{ project.name }}</span>
      <span class="current-indicator" *ngIf="project.name === projects?.current">✓</span>
    </button>
    
    <div *ngIf="getAvailableProjects().length === 0" class="dropdown-empty">
      Aucun projet disponible
    </div>
  </div>
</div>

<!-- Backdrop to close dropdown -->
<div 
  *ngIf="isExpanded"
  class="dropdown-backdrop"
  (click)="closeDropdown()"
></div>
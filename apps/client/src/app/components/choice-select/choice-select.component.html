@if (isVisible) {
  <form class="choice-form" (ngSubmit)="onSubmit()">
    <!-- Label at top -->
    <div class="choice-label" [innerHTML]="renderedLabel$ | async"></div>

    <!-- Select and button in grouped container -->
    <div class="select-button-row" [class.focused]="isFocused">
      <select
        class="choice-select-inline"
        [(ngModel)]="selectedValue"
        name="choice"
        required
        #choiceSelect
        (change)="onSelectChange()"
        (keydown.enter)="onSubmit()"
        (focus)="isFocused = true"
        (blur)="isFocused = false"
      >
        <option value="" disabled>-- Select an option --</option>
        @for (option of options; track option.value) {
          <option [value]="option.value" [disabled]="option.disabled || option.value === '__separator__'">
            {{ option.label }}
          </option>
        }
      </select>

      <button
        type="submit"
        class="submit-btn"
        mat-icon-button
        [disabled]="!selectedValue || selectedValue === '__separator__'"
        title="Submit selection"
      >
        <mat-icon>send</mat-icon>
      </button>
    </div>
  </form>
}
